      SUBROUTINE FIJ(IREF1, IREF2, IREF3, F12, F13, F23, IFF1,
     .               IFF2, IFF3)
C     ******************************************************************
C     *    ESTIMATE BINARY PAIR INTERACTION COEFFICIENT                *
C     *    SOURCE: ESTIMATION PROCEDURE OF REFPROP 4.0                 *
C     ******************************************************************
C
      DIMENSION B(3,34), DP(34), TC(34), FF0(34,34), IFF(34,34)
 
      DATA B / 0.178148, -1.82363E-4, -2.54131E-8,         !01: R11
     .         0.165350, -2.65758E-4,  9.13878E-8,         !02: R12
     .         0.129485, -1.93746E-4, -9.01119E-8,         !03: R13
     .         0.228716, -2.36350E-4, -0.32793E-7,         !04: n-C5
     .         0.099664, -1.57113E-4, -2.95020E-7,         !05: R14
     .         0.117395, -1.40272E-4, -0.52161E-7,         !06: R22
     .         0.090205, -1.25602E-4, -0.50675E-7,         !07: R23
     .         0.234712, -2.11131E-4, -7.33758E-8,         !08: R113
     .         0.221874, -2.88304E-4,  1.81892E-8,         !09: R114
     .         0.169138, -2.41068E-4,  0.67566E-7,         !10: R142b
     .         0.133264, -2.03633E-4,  0.77725E-7,         !11: R152a
     .         0.265720, -2.20418E-4, -1.68111E-7,         !12: R216a
     .         0.149380, -1.80851E-4, -1.18813E-7,         !13: R125
     .         0.133153, -1.58954E-4, -0.58331E-7,         !14: R143a
     .         0.141750, -1.62763E-4, -0.62893E-7,         !15: R134a
     .         0.199549, -1.89493E-4, -0.67680E-7,         !16: R123
     .         0.225542, -1.89843E-4, -2.63546E-7,         !17: RC318
     .         0.13856,  -1.59910E-4, -0.55880E-7,         !18: R134
     .         0.125065, -2.01031E-4,  7.85060E-8,         !19: RC270 (C-C3H6)
     .         0.180853, -1.61856E-4, -6.23542E-8,         !20: R141b
     .         0.227727, -2.44140E-4, -2.96940E-8,         !21: i-C5
     .         0.142963, -1.76519E-4, -5.78514E-8,         !22: R290
     .         0.1908,   -2.48360E-4, -0.28460E-7,         !23: R600
     .         0.1803,   -1.87190E-4, -8.17780E-8,         !24: R600a
     .         0.077988, -0.75238E-4, -0.53011E-7,         !25: R32
     .         0.125318, -1.28616E-4, -1.09990E-7,         !26: R1270
     .         0.173954, -1.79579E-4, -1.04407E-7,         !27: R124
     .         0.181713, -1.79799E-4, -2.30503E-7,         !28: R115
     .         0.164126, -6.60150E-5, -3.83529E-7,         !29: R216 (CE-216)
     .         0.157821,  0.0001235,  -2.51097E-7,         !30: E125
     .         0.201686, -2.03580E-4, -3.64426E-8,         !31: R123a
     .         0.122129, -8.97418E-5, -1.06872E-7,         !32: R143
     .         0.205911, -1.49329E-4, -4.30009E-7,         !33: R218
     .         0.171895, -2.30888E-4,  2.83780E-8 /        !34: E134
 
      DATA DP /0.45, 0.51, 0.51, 0.00, 0.00, 1.46, 1.65, 0.00,
     .         0.60, 2.14, 2.26, 0.00, 1.56, 2.34, 2.06, 1.36,
     .         0.00, 3.61, 0.00, 2.01, 0.00, 0.00, 0.00, 0.00,
     .         1.98, 0.37, 1.47, 0.52, 0.84, 2.55, 1.30, 3.96,
     .         0.00, 5.61 /
 
      DATA TC / 471.2, 385.0, 302.0, 469.5, 227.5, 369.3, 299.1,
     .          487.5, 418.8, 410.3, 386.7, 453.1, 339.4, 346.3,
     .          374.3, 456.9, 388.4, 392.1, 398.3, 477.3, 460.5,
     .          369.9, 425.2, 407.9, 351.4, 364.9, 395.6, 353.1,
     .          361.8, 353.8, 461.1, 429.9, 345.1, 420.3 /
 
      DATA FF0/ 1156*0.0 /,     IFF/ 1156*0 /
 
      DATA FF0( 2, 1)/  .010/, IFF( 2, 1)/ 1/              !R12-R11
      DATA FF0( 3, 1)/  .000/, IFF( 3, 1)/ 1/              !R13-R11
      DATA FF0( 6, 1)/  .036/, IFF( 6, 1)/ 1/              !R22-R11
      DATA FF0( 7, 1)/  .112/, IFF( 7, 1)/ 1/              !R23-R11
      DATA FF0(10, 1)/  .019/, IFF(10, 1)/ 1/              !R142b-R11
      DATA FF0(11, 1)/  .077/, IFF(11, 1)/ 1/              !R152a-R11
      DATA FF0(16, 1)/  .013/, IFF(16, 1)/ 1/              !R123-R11
      DATA FF0(21, 1)/  .005/, IFF(21, 1)/ 1/              !iC5-R11
      DATA FF0( 3, 2)/  .030/, IFF( 3, 2)/ 1/              !R13-R12
      DATA FF0( 6, 2)/  .045/, IFF( 6, 2)/ 1/              !R22-R12
      DATA FF0( 7, 2)/  .000/, IFF( 7, 2)/ 1/              !R23-R12
      DATA FF0( 9, 2)/  .000/, IFF( 9, 2)/ 1/              !R114-R12
      DATA FF0(10, 2)/  .036/, IFF(10, 2)/ 1/              !R142b-R12
      DATA FF0(11, 2)/  .071/, IFF(11, 2)/ 1/              !R152a-R12
      DATA FF0(17, 2)/  .024/, IFF(17, 2)/ 1/              !RC318-R12
      DATA FF0(18, 2)/  .099/, IFF(18, 2)/ 1/              !R134-R12
      DATA FF0(27, 2)/  .004/, IFF(27, 2)/ 1/              !R124-R12
      DATA FF0( 5, 3)/  .031/, IFF( 5, 3)/ 1/              !R14-R13
      DATA FF0( 6, 3)/  .014/, IFF( 6, 3)/ 1/              !R22-R13
      DATA FF0( 7, 3)/  .093/, IFF( 7, 3)/ 1/              !R23-R13
      DATA FF0( 8, 3)/  .014/, IFF( 8, 3)/ 1/              !R113-R13
      DATA FF0(23, 3)/  .071/, IFF(23, 3)/ 1/              !R600-R13
      DATA FF0(24, 3)/  .054/, IFF(24, 3)/ 1/              !R600a-R13
      DATA FF0( 7, 5)/  .116/, IFF( 7, 5)/ 1/              !R23-R14
      DATA FF0( 7, 6)/  .000/, IFF( 7, 6)/ 1/              !R23-R22
      DATA FF0( 8, 6)/  .019/, IFF( 8, 6)/ 1/              !R113-R22
      DATA FF0( 9, 6)/  .025/, IFF( 9, 6)/ 1/              !R114-R22
      DATA FF0(10, 6)/  .027/, IFF(10, 6)/ 1/              !R142b-R22
      DATA FF0(11, 6)/ -.048/, IFF(11, 6)/ 1/              !R152a-R22
      DATA FF0(15, 6)/  .009/, IFF(15, 6)/ 1/              !R134a-R22
      DATA FF0(17, 6)/  .041/, IFF(17, 6)/ 1/              !RC318-R22
      DATA FF0(22, 6)/  .041/, IFF(22, 6)/ 1/              !R290-R22
      DATA FF0(27, 6)/  .009/, IFF(27, 6)/ 1/              !R124-R22
      DATA FF0(28, 6)/  .046/, IFF(28, 6)/ 1/              !R115-R22
      DATA FF0(33, 6)/  .070/, IFF(33, 6)/ 1/              !R218-R22
      DATA FF0(34, 6)/  .074/, IFF(34, 6)/ 1/              !E134-R22
      DATA FF0( 8, 7)/  .059/, IFF( 8, 7)/ 1/              !R113-R23
      DATA FF0( 9, 7)/  .034/, IFF( 9, 7)/ 1/              !R114-R23
      DATA FF0(10, 7)/  .026/, IFF(10, 7)/ 1/              !R142b-R23
      DATA FF0( 9, 8)/  .003/, IFF( 9, 8)/ 1/              !R114-R113
      DATA FF0(11, 8)/  .041/, IFF(11, 8)/ 1/              !R152a-R113
      DATA FF0(23, 9)/  .037/, IFF(23, 9)/ 1/              !R600-R114
      DATA FF0(28, 9)/  .018/, IFF(28, 9)/ 1/              !R115-R114
      DATA FF0(15,11)/  .015/, IFF(15,11)/ 1/              !R134a-R152a
      DATA FF0(18,11)/ -.018/, IFF(18,11)/ 1/              !R134-R152a
      DATA FF0(19,11)/  .086/, IFF(19,11)/ 1/              !RC270-R152a
      DATA FF0(22,11)/  .132/, IFF(22,11)/ 1/              !R290-R152a
      DATA FF0(23,11)/  .110/, IFF(23,11)/ 1/              !R600-R152a
      DATA FF0(24,11)/  .106/, IFF(24,11)/ 1/              !R600a-R152a
      DATA FF0(25,11)/ -.006/, IFF(25,11)/ 1/              !R32-R152a
      DATA FF0(28,11)/  .087/, IFF(28,11)/ 1/              !R115-R152a
      DATA FF0(14,13)/ -.011/, IFF(14,13)/ 1/              !R143a-R125
      DATA FF0(15,13)/  .005/, IFF(15,13)/ 1/              !R134a-R125
      DATA FF0(25,13)/ -.020/, IFF(25,13)/ 1/              !R32-R125
      DATA FF0(28,14)/  .055/, IFF(28,14)/ 1/              !R115-R143a
      DATA FF0(16,15)/  .032/, IFF(16,15)/ 1/              !R123-R134a
      DATA FF0(18,15)/  .007/, IFF(18,15)/ 1/              !R134-R134a
      DATA FF0(19,15)/  .120/, IFF(19,15)/ 1/              !RC270-R134a
      DATA FF0(20,15)/  .048/, IFF(20,15)/ 1/              !R141b-R134a
      DATA FF0(22,15)/  .154/, IFF(22,15)/ 1/              !R290-R134a
      DATA FF0(24,15)/  .154/, IFF(24,15)/ 1/              !R600a-R134a
      DATA FF0(25,15)/ -.010/, IFF(25,15)/ 1/              !R32-R134a
      DATA FF0(20,16)/ -.006/, IFF(20,16)/ 1/              !R141b-R123
      DATA FF0(21,16)/  .037/, IFF(21,16)/ 1/              !iC5-R123
      DATA FF0(24,17)/ -.015/, IFF(24,17)/ 1/              !R600a-RC318
      DATA FF0(28,22)/  .068/, IFF(28,22)/ 1/              !R115-R290
      DATA FF0(28,25)/  .063/, IFF(28,25)/ 1/              !R115-R32
      DATA FF0(33,25)/  .038/, IFF(33,25)/ 1/              !R218-R32
 
C
C          MOLECULAR VOLUME FUNCTION
C
      V(IREF) = B(1,IREF) + 0.7500*B(2,IREF)*TC(IREF)
     .                    + 0.5625*B(3,IREF)*TC(IREF)*TC(IREF)
C
C         INITIALIZE
C
      F12 = 0
      F13 = 0
      F23 = 0
 
      IFF1 = 1
      IFF2 = 1
      IFF3 = 1
 
      DO i = 1, 34
        IFF(i,i) = 1
        FF0(i,i) = 0
      END DO
C
C          FIRST INTERACTION COEFFICIENT
C
      IF(IREF2 .EQ. 0) RETURN
 
      Z1 = DP(IREF1) / V(IREF1)
      Z2 = DP(IREF2) / V(IREF2)
      IF (Z1 .LT. Z2) THEN
         Z1 = DP(IREF2) / V(IREF2)
         Z2 = DP(IREF1) / V(IREF1)
      END IF
 
      Z = 6.0 + Z1 - 1.6*Z2
      IF (Z .GE. 0.0) THEN
         F12 =  1.00E-06*Z**4/(1.0 + 2.75E-04*Z**3) + 2.2E-04*Z
      ELSE
         F12 = -6.83E-07*Z**4/(1.0 - 2.75E-04*Z**3) + 2.2E-04*Z
      END IF
C
C          SECOND INTERACTION COEFFICIENT
C
      IF(IREF3 .NE. 0) THEN
 
         Z1 = DP(IREF1) / V(IREF1)
         Z2 = DP(IREF3) / V(IREF3)
         IF (Z1 .LT. Z2) THEN
            Z1 = DP(IREF3) / V(IREF3)
            Z2 = DP(IREF1) / V(IREF1)
         END IF
 
         Z = 6.0 + Z1 - 1.6*Z2
         IF (Z .GE. 0.0) THEN
            F13 =  1.00E-06*Z**4/(1.0 + 2.75E-04*Z**3) + 2.2E-04*Z
         ELSE
            F13 = -6.83E-07*Z**4/(1.0 - 2.75E-04*Z**3) + 2.2E-04*Z
         END IF
C
C          THIRD INTERACTION COEFFICIENT
C
         Z1 = DP(IREF2) / V(IREF2)
         Z2 = DP(IREF3) / V(IREF3)
         IF (Z1 .LT. Z2) THEN
            Z1 = DP(IREF3) / V(IREF3)
            Z2 = DP(IREF2) / V(IREF2)
         END IF
 
         Z = 6.0 + Z1 - 1.6*Z2
         IF (Z .GE. 0.0) THEN
            F23 =  1.00E-06*Z**4/(1.0 + 2.75E-04*Z**3) + 2.2E-04*Z
         ELSE
            F23 = -6.83E-07*Z**4/(1.0 - 2.75E-04*Z**3) + 2.2E-04*Z
         END IF
 
      END IF
 
      DO  I = 1, 34
        DO  J = 1, 34
          FF0(I,J) = FF0(J,I)
          IFF(I,J) = IFF(J,I)
        END DO
      END DO
 
      IF (IFF(IREF1,IREF2) .EQ. 1)  F12 = FF0(IREF1,IREF2)
      IF (IFF(IREF1,IREF3) .EQ. 1)  F13 = FF0(IREF1,IREF3)
      IF (IFF(IREF2,IREF3) .EQ. 1)  F23 = FF0(IREF2,IREF3)
      IFF1 = IFF(IREF1, IREF2)
      IFF2 = IFF(IREF1, IREF3)
      IFF3 = IFF(IREF2, IREF3)
 
      RETURN
      END
 
